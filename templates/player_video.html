{% extends "_base.html" %}
{% block title %}Playing Video: {{ display_filename }} - Pi Streamer{% endblock %}

{% block head_extra %}
<link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
<style>
    html, body { height: 100%; margin: 0; padding: 0; }
    body {
        display: flex; flex-direction: column;
        background-color: #1e1e1e; color: #e0e0e0;
        min-height: 100vh;
    }
     main.content-area { /* Let main grow and center its content */
        display: flex; flex-direction: column;
        align-items: center; /* Center items horizontally */
        justify-content: center; /* Center items vertically */
        flex-grow: 1; /* Allow main to expand */
        padding: 20px; /* Add overall padding */
        box-sizing: border-box;
        width: 100%;
    }
    /* Styles for .info-bar, .media-player-container, .video-js, etc. */
    .info-bar { /* Centering handled by main */
        display: flex; justify-content: space-between; align-items: center;
        flex-wrap: wrap; gap: 15px; width: 100%; max-width: 960px;
        margin-bottom: 15px;
    }
    .media-player-container { /* Centering handled by main */
         width: 100%; max-width: 960px; background-color: #000;
    }
    h2.video-title {
        color: #f0f0f0; margin: 0; font-size: 1.3em; text-align: left;
        word-break: break-all; flex-grow: 1;
    }
    h2.problematic { color: #ffcc00; font-style: italic; }
    h2.problematic::after { content: ' ⚠️'; display: inline-block; }
    .top-controls { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }

    /* --- Player Container --- */
    .media-player-container {
        width: 100%; /* Use 100% of main's width */
        max-width: 960px; /* Limit player size */
        background-color: #000;
        margin-left: auto; /* Center the container */
        margin-right: auto;
        /* Removed margin-bottom, spacing handled by main container gap if needed */
    }
    /* --- Video.js Player Styling --- */
    .video-js { width: 100%; height: auto; aspect-ratio: 16 / 9; display: block; } /* Ensure display block */
    .vjs-control-bar { background-color: rgba(43, 51, 63, .85); }
    /* ... other VJS styles (captions etc.) ... */
    .video-js .vjs-text-track-display > div { left: 0 !important; right: 0 !important; width: 100% !important; text-align: center !important; bottom: 2em !important; }
    .video-js .vjs-text-track-cue > div { display: inline; }
    .video-js .vjs-text-track-cue span { background-color: rgba(0, 0, 0, 0.75) !important; padding: 0.1em 0.3em; border-radius: 3px; }

    /* --- Top Controls Styling --- */
    label { font-size: .9em; color: #ccc; margin-right: 4px;}
    select { padding: 5px 8px; background-color: #333; color: #e0e0e0; border: 1px solid #555; border-radius: 4px; font-size: .9em; max-width: 150px; cursor: pointer;}
    a.button-link, button.nav-button { text-decoration: none; color: #fff; padding: 8px 15px; border-radius: 4px; background-color: #444; transition: background-color .2s; font-size: .9em; white-space: nowrap; border: none; font-family: inherit; cursor: pointer; }
    a.button-link:hover, button.nav-button:hover { background-color: #555; }
    button.nav-button:disabled { background-color: #333; color: #777; cursor: not-allowed; }
    a.back-link { background-color: #6c757d; } a.back-link:hover { background-color: #5a6268; }
    .quality-selector-container, .audio-track-selector { display: none; margin-left: 10px; }
    .vjs-error-display .vjs-modal-dialog-content { color: #ffcccc; background-color: rgba(50, 0, 0, 0.7); }
</style>
{% endblock %}

{# The rest of the template (content block etc.) remains the same #}
{% block content %}
<div class="info-bar">
    <h2 class="video-title {% if is_problematic_filename %}problematic{% endif %}">{{ display_filename }}</h2>
    <div class="top-controls">
        {% if prev_link_url %}<a href="{{ prev_link_url }}" class="button-link nav-button prev-link" title="Previous Video">⏮️ Prev</a>
        {% else %}<button class="nav-button" disabled title="No previous video">⏮️ Prev</button>{% endif %}
        {% if next_link_url %}<a href="{{ next_link_url }}" class="button-link nav-button next-link" title="Next Video">Next ⏭️</a>
        {% else %}<button class="nav-button" disabled title="No next video">Next ⏭️</button>{% endif %}
        <div class="quality-selector-container"><label for="qualitySelector">Quality:</label><select id="qualitySelector"></select></div>
        <div class="audio-track-selector"><label for="audioTrackSelector">Audio:</label><select id="audioTrackSelector"></select></div>
        <a href="{{ back_link_url }}" class="button-link back-link" title="Back to file list">Back to List</a>
    </div>
</div>
<div class="media-player-container">
    <video id="vjsPlayer" class="video-js vjs-big-play-centered" controls preload="auto" playsinline>
        <source src="{{ initial_stream_url }}" type="{{ initial_mime_type }}">
        <p class="vjs-no-js">Please enable JavaScript and use a browser that supports HTML5 video.</p>
    </video>
</div>
{% endblock %}

{# Keep the scripts_extra block as it was #}
{% block scripts_extra %}
<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
<script>
    // ... (Your existing JavaScript for quality switching, audio tracks, auto-advance) ...
    (function() {
        'use strict';
        // ... all the JS code ...
    })();
</script>
{% endblock %}